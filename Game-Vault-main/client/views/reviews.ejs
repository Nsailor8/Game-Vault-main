<!DOCTYPE html>
<html lang="en">
  <%- include('partials/head', { pageTitle: 'Reviews' }) %>
<body>
  <%- include('partials/header') %>

  <div class="container">
    <main class="main-content">
      <!-- Reviews Section -->
      <section id="reviewsSection" class="content-section active">
        <div class="section-header">
          <h2>Reviews</h2>
          <button id="addReviewBtn" class="btn btn-primary">Write a Review</button>
        </div>
        <div class="reviews-content">
          <div id="reviewsContainer" class="list-container">
            <!-- Reviews will be populated here by JavaScript -->
            <div class="empty-state">
              <i class="fas fa-star"></i>
              <h3>Loading...</h3>
              <p>Please wait while we load your reviews.</p>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <%- include('partials/loginModal') %>
  <%- include('partials/reviewModal') %>

  <script src="/app.js"></script>
  <script>
    // Initialize the app when the page loads
    document.addEventListener('DOMContentLoaded', async () => {
      console.log('Reviews page - DOM Content Loaded');
      
      // Wait for app to initialize
      if (window.app) {
        // Check auth status first
        await window.app.checkAuthStatus();
        
        // If user is logged in, update reviews
        if (window.app.currentUser) {
          window.app.updateReviews();
        }
      } else {
        // Wait a bit for app to initialize
        setTimeout(async () => {
          if (window.app) {
            await window.app.checkAuthStatus();
            if (window.app.currentUser) {
              window.app.updateReviews();
            }
          }
        }, 500);
      }
    });
  </script>
</body>
</html>
